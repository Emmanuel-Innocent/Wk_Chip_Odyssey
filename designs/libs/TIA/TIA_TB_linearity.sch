v {xschem version=3.4.7 file_version=1.2}
G {}
K {}
V {}
S {}
E {}
N 2190 -1340 2190 -1270 {lab=vdd}
N 1560 -1240 2150 -1240 {lab=i_ref}
N 1520 -1340 1520 -1270 {lab=vdd}
N 1520 -1340 2190 -1340 {lab=vdd}
N 2910 -1340 2910 -1270 {lab=vdd}
N 2190 -1340 2770 -1340 {lab=vdd}
N 2320 -1240 2730 -1240 {lab=i_ref}
N 2320 -1290 2320 -1240 {lab=i_ref}
N 2120 -1290 2320 -1290 {lab=i_ref}
N 2120 -1290 2120 -1240 {lab=i_ref}
N 1990 -1010 1990 -930 {lab=#net1}
N 1990 -1010 2190 -1010 {lab=#net1}
N 2190 -1100 2190 -1010 {lab=#net1}
N 2190 -1010 2400 -1010 {lab=#net1}
N 2400 -1000 2400 -930 {lab=#net1}
N 2400 -1010 2400 -1000 {lab=#net1}
N 1990 -870 1990 -620 {lab=#net2}
N 2400 -870 2400 -620 {lab=cs}
N 2030 -590 2360 -590 {lab=#net2}
N 2060 -640 2060 -590 {lab=#net2}
N 1990 -640 2060 -640 {lab=#net2}
N 1990 -560 1990 -470 {lab=vss}
N 2400 -560 2400 -470 {lab=vss}
N 1990 -470 2400 -470 {lab=vss}
N 2910 -1100 2910 -790 {lab=cd}
N 2400 -470 2770 -470 {lab=vss}
N 2330 -640 2330 -590 {lab=#net2}
N 2330 -640 2470 -640 {lab=#net2}
N 2470 -640 2470 -590 {lab=#net2}
N 2470 -590 3040 -590 {lab=#net2}
N 3350 -560 3350 -480 {lab=vss}
N 2910 -470 3220 -470 {lab=vss}
N 3350 -480 3350 -470 {lab=vss}
N 3350 -900 3350 -620 {lab=out}
N 2910 -1340 3220 -1340 {lab=vdd}
N 3350 -1230 3350 -960 {lab=vdd}
N 1850 -900 1950 -900 {lab=in_n}
N 2440 -900 2530 -900 {lab=in_p}
N 1590 -1240 1590 -1170 {lab=i_ref}
N 3350 -790 3430 -790 {lab=out}
N 2160 -1660 2160 -1620 {lab=GND}
N 2070 -1660 2070 -1620 {lab=vss}
N 2160 -1760 2160 -1720 {lab=vss}
N 2070 -1760 2070 -1720 {lab=vdd}
N 2180 -1370 2180 -1340 {lab=vdd}
N 2240 -470 2240 -450 {lab=vss}
N 2910 -700 2910 -470 {lab=vss}
N 2910 -790 2910 -760 {lab=cd}
N 2690 -800 2690 -730 {lab=cs}
N 1970 -590 1990 -590 {lab=vss}
N 1970 -590 1970 -540 {lab=vss}
N 1970 -540 1990 -540 {lab=vss}
N 2400 -590 2420 -590 {lab=vss}
N 2420 -590 2420 -540 {lab=vss}
N 2400 -540 2420 -540 {lab=vss}
N 2910 -730 2930 -730 {lab=vss}
N 2930 -730 2930 -680 {lab=vss}
N 2910 -680 2930 -680 {lab=vss}
N 3350 -590 3370 -590 {lab=vss}
N 3370 -590 3370 -540 {lab=vss}
N 3350 -540 3370 -540 {lab=vss}
N 3350 -930 3370 -930 {lab=vss}
N 2910 -1240 2930 -1240 {lab=vdd}
N 2930 -1290 2930 -1240 {lab=vdd}
N 2910 -1290 2930 -1290 {lab=vdd}
N 2190 -1240 2210 -1240 {lab=vdd}
N 2210 -1280 2210 -1240 {lab=vdd}
N 2190 -1280 2210 -1280 {lab=vdd}
N 1500 -1240 1520 -1240 {lab=vdd}
N 1500 -1280 1500 -1240 {lab=vdd}
N 1500 -1280 1520 -1280 {lab=vdd}
N 1990 -900 2020 -900 {lab=vdd}
N 2360 -900 2400 -900 {lab=vdd}
N 2020 -900 2360 -900 {lab=vdd}
N 2770 -1340 2910 -1340 {lab=vdd}
N 2730 -1240 2870 -1240 {lab=i_ref}
N 3220 -1340 3340 -1340 {lab=vdd}
N 3340 -1340 3350 -1340 {lab=vdd}
N 3180 -930 3310 -930 {lab=cd}
N 3040 -590 3310 -590 {lab=#net2}
N 3220 -470 3350 -470 {lab=vss}
N 2770 -470 2910 -470 {lab=vss}
N 2730 -730 2870 -730 {lab=cs}
N 1990 -1660 1990 -1620 {lab=vss}
N 1520 -1210 1520 -1160 {lab=i_ref}
N 2190 -1210 2190 -1180 {lab=#net1}
N 2910 -1210 2910 -1160 {lab=cd}
N 2930 -1240 2940 -1240 {lab=vdd}
N 3350 -1340 3350 -1230 {lab=vdd}
N 1520 -1160 1520 -1100 {lab=i_ref}
N 1520 -1170 1590 -1170 {lab=i_ref}
N 2190 -1180 2190 -1100 {lab=#net1}
N 2910 -1160 2910 -1100 {lab=cd}
N 2690 -730 2730 -730 {lab=cs}
N 2400 -730 2690 -730 {lab=cs}
N 2910 -930 3180 -930 {lab=cd}
N 1540 -1770 1600 -1770 {lab=in_p}
N 1540 -1710 1600 -1710 {lab=vdd}
N 1540 -1680 1600 -1680 {lab=vss}
N 2240 -1660 2240 -1620 {lab=GND}
N 2240 -1760 2240 -1720 {lab=i_ref}
N 1540 -1650 1600 -1650 {lab=i_ref}
N 3630 -790 3630 -680 {lab=out}
N 3430 -790 3630 -790 {lab=out}
N 3630 -620 3630 -470 {lab=vss}
N 3350 -470 3630 -470 {lab=vss}
N 3630 -790 3710 -790 {lab=out}
N 3710 -790 3710 -410 {lab=out}
N 1760 -900 1760 -410 {lab=in_n}
N 1760 -900 1850 -900 {lab=in_n}
N 1760 -330 2690 -330 {lab=in_n}
N 1760 -410 1760 -330 {lab=in_n}
N 3710 -410 3710 -330 {lab=out}
N 3040 -330 3710 -330 {lab=out}
N 2690 -330 2750 -330 {lab=in_n}
N 1990 -1760 1990 -1720 {lab=in_p}
N 1750 -1660 1750 -1620 {lab=vss}
N 1750 -1760 1750 -1720 {lab=in_n}
N 1750 -1780 1750 -1760 {lab=in_n}
N 1750 -1560 1750 -1510 {lab=vss}
N 1750 -1620 1750 -1560 {lab=vss}
N 2980 -330 3040 -330 {lab=out}
N 2800 -390 2800 -350 {lab=vdd}
N 2750 -330 2770 -330 {lab=in_n}
N 2830 -330 2980 -330 {lab=out}
N 2780 -800 2810 -800 {lab=#net3}
N 2870 -800 2910 -800 {lab=cd}
N 2690 -800 2720 -800 {lab=cs}
N 2750 -860 2750 -820 {lab=vdd}
C {symbols/pfet_03v3.sym} 2170 -1240 0 0 {name=MP_TAIL
L=2u
W=15u
nf=3
m=8
ad="'int((nf+1)/2) * W/nf * 0.18u'"
pd="'2*int((nf+1)/2) * (W/nf + 0.18u)'"
as="'int((nf+2)/2) * W/nf * 0.18u'"
ps="'2*int((nf+2)/2) * (W/nf + 0.18u)'"
nrd="'0.18u / W'" nrs="'0.18u / W'"
sa=0 sb=0 sd=0
model=pfet_03v3
spiceprefix=X
}
C {symbols/pfet_03v3.sym} 1970 -900 0 0 {name=MP_DIFF_L
L=2u
W=10u
nf=2
m=10
ad="'int((nf+1)/2) * W/nf * 0.18u'"
pd="'2*int((nf+1)/2) * (W/nf + 0.18u)'"
as="'int((nf+2)/2) * W/nf * 0.18u'"
ps="'2*int((nf+2)/2) * (W/nf + 0.18u)'"
nrd="'0.18u / W'" nrs="'0.18u / W'"
sa=0 sb=0 sd=0
model=pfet_03v3
spiceprefix=X
}
C {symbols/pfet_03v3.sym} 2420 -900 0 1 {name=MP_DIFF_R
L=2u
W=10u
nf=2
m=10
ad="'int((nf+1)/2) * W/nf * 0.18u'"
pd="'2*int((nf+1)/2) * (W/nf + 0.18u)'"
as="'int((nf+2)/2) * W/nf * 0.18u'"
ps="'2*int((nf+2)/2) * (W/nf + 0.18u)'"
nrd="'0.18u / W'" nrs="'0.18u / W'"
sa=0 sb=0 sd=0
model=pfet_03v3
spiceprefix=X
}
C {symbols/pfet_03v3.sym} 2890 -1240 0 0 {name=MP_CS_LOAD
L=2u
W=15u
nf=3
m=25
ad="'int((nf+1)/2) * W/nf * 0.18u'"
pd="'2*int((nf+1)/2) * (W/nf + 0.18u)'"
as="'int((nf+2)/2) * W/nf * 0.18u'"
ps="'2*int((nf+2)/2) * (W/nf + 0.18u)'"
nrd="'0.18u / W'" nrs="'0.18u / W'"
sa=0 sb=0 sd=0
model=pfet_03v3
spiceprefix=X
}
C {symbols/pfet_03v3.sym} 1540 -1240 0 1 {name=MP_MIRROR
L=2u
W=15u
nf=3
m=1
ad="'int((nf+1)/2) * W/nf * 0.18u'"
pd="'2*int((nf+1)/2) * (W/nf + 0.18u)'"
as="'int((nf+2)/2) * W/nf * 0.18u'"
ps="'2*int((nf+2)/2) * (W/nf + 0.18u)'"
nrd="'0.18u / W'" nrs="'0.18u / W'"
sa=0 sb=0 sd=0
model=pfet_03v3
spiceprefix=X
}
C {symbols/nfet_03v3.sym} 2380 -590 0 0 {name=MN_LOAD_R
L=2u
W=12u
nf=1
m=1
ad="'int((nf+1)/2) * W/nf * 0.18u'"
pd="'2*int((nf+1)/2) * (W/nf + 0.18u)'"
as="'int((nf+2)/2) * W/nf * 0.18u'"
ps="'2*int((nf+2)/2) * (W/nf + 0.18u)'"
nrd="'0.18u / W'" nrs="'0.18u / W'"
sa=0 sb=0 sd=0
model=nfet_03v3
spiceprefix=X
}
C {symbols/nfet_03v3.sym} 2010 -590 0 1 {name=MN_LOAD_L
L=2u
W=12u
nf=1
m=1
ad="'int((nf+1)/2) * W/nf * 0.18u'"
pd="'2*int((nf+1)/2) * (W/nf + 0.18u)'"
as="'int((nf+2)/2) * W/nf * 0.18u'"
ps="'2*int((nf+2)/2) * (W/nf + 0.18u)'"
nrd="'0.18u / W'" nrs="'0.18u / W'"
sa=0 sb=0 sd=0
model=nfet_03v3
spiceprefix=X
}
C {symbols/nfet_03v3.sym} 2890 -730 0 0 {name=MN_CS
L=2u
W=20u
nf=10
m=11
ad="'int((nf+1)/2) * W/nf * 0.18u'"
pd="'2*int((nf+1)/2) * (W/nf + 0.18u)'"
as="'int((nf+2)/2) * W/nf * 0.18u'"
ps="'2*int((nf+2)/2) * (W/nf + 0.18u)'"
nrd="'0.18u / W'" nrs="'0.18u / W'"
sa=0 sb=0 sd=0
model=nfet_03v3
spiceprefix=X
}
C {symbols/nfet_03v3.sym} 3330 -930 0 0 {name=MN_CD
L=2u
W=10u
nf=10
m=26
ad="'int((nf+1)/2) * W/nf * 0.18u'"
pd="'2*int((nf+1)/2) * (W/nf + 0.18u)'"
as="'int((nf+2)/2) * W/nf * 0.18u'"
ps="'2*int((nf+2)/2) * (W/nf + 0.18u)'"
nrd="'0.18u / W'" nrs="'0.18u / W'"
sa=0 sb=0 sd=0
model=nfet_03v3
spiceprefix=X
}
C {symbols/nfet_03v3.sym} 3330 -590 0 0 {name=MN_CD_LOAD
L=2u
W=12u
nf=1
m=8
ad="'int((nf+1)/2) * W/nf * 0.18u'"
pd="'2*int((nf+1)/2) * (W/nf + 0.18u)'"
as="'int((nf+2)/2) * W/nf * 0.18u'"
ps="'2*int((nf+2)/2) * (W/nf + 0.18u)'"
nrd="'0.18u / W'" nrs="'0.18u / W'"
sa=0 sb=0 sd=0
model=nfet_03v3
spiceprefix=X
}
C {vsource.sym} 2070 -1690 0 0 {name=V3 value=3.3 savecurrent=false}
C {vsource.sym} 2160 -1690 0 0 {name=V4 value=0 savecurrent=false}
C {gnd.sym} 2160 -1620 0 0 {name=l4 lab=GND}
C {lab_pin.sym} 2070 -1760 3 1 {name=p12 sig_type=std_logic lab=vdd}
C {lab_pin.sym} 2070 -1620 1 1 {name=p17 sig_type=std_logic lab=vss}
C {lab_pin.sym} 2180 -1370 3 1 {name=p18 sig_type=std_logic lab=vdd}
C {lab_pin.sym} 2240 -450 1 1 {name=p32 sig_type=std_logic lab=vss}
C {lab_pin.sym} 3370 -930 0 1 {name=p38 sig_type=std_logic lab=vss}
C {lab_pin.sym} 2530 -900 0 1 {name=p39 sig_type=std_logic lab=in_p}
C {devices/ngspice_get_expr.sym} 3040 -1270 0 0 {name=r106 
node="[format %.4g [expr [ngspice::get_node \{@m.xmp_cs_load.m0[gm]\}] / [ngspice::get_node \{i(@m.xmp_cs_load.m0[id])\}]]]"
descr="gm/ID="}
C {devices/ngspice_get_value.sym} 3040 -1240 0 0 {name=r107 node=v(@m.xmp_cs_load.m0[vdsat])
descr="vdsat="}
C {devices/ngspice_get_value.sym} 3040 -1210 0 0 {name=r108 node=v(@m.xmp_cs_load.m0[vds])
descr="vds="}
C {devices/ngspice_get_value.sym} 3100 -1270 0 0 {name=r109 node=i(@m.xmp_cs_load.m0[id])
descr="id="}
C {devices/ngspice_get_value.sym} 3100 -1240 0 0 {name=r110 node=@m.xmp_cs_load.m0[gm]
descr="gm="}
C {devices/ngspice_get_expr.sym} 3470 -950 0 0 {name=r111 
node="[format %.4g [expr [ngspice::get_node \{@m.xmn_cd.m0[gm]\}] / [ngspice::get_node \{i(@m.xmn_cd.m0[id])\}]]]"
descr="gm/ID="}
C {devices/ngspice_get_value.sym} 3470 -920 0 0 {name=r112 node=v(@m.xmn_cd.m0[vdsat])
descr="vdsat="}
C {devices/ngspice_get_value.sym} 3470 -890 0 0 {name=r113 node=v(@m.xmn_cd.m0[vds])
descr="vds="}
C {devices/ngspice_get_value.sym} 3530 -950 0 0 {name=r114 node=i(@m.xmn_cd.m0[id])
descr="id="}
C {devices/ngspice_get_value.sym} 3530 -920 0 0 {name=r115 node=@m.xmn_cd.m0[gm]
descr="gm="}
C {devices/ngspice_get_expr.sym} 3470 -600 0 0 {name=r116 
node="[format %.4g [expr [ngspice::get_node \{@m.xmn_cd_load.m0[gm]\}] / [ngspice::get_node \{i(@m.xmn_cd_load.m0[id])\}]]]"
descr="gm/ID="}
C {devices/ngspice_get_value.sym} 3470 -570 0 0 {name=r117 node=v(@m.xmn_cd_load.m0[vdsat])
descr="vdsat="}
C {devices/ngspice_get_value.sym} 3470 -540 0 0 {name=r118 node=v(@m.xmn_cd_load.m0[vds])
descr="vds="}
C {devices/ngspice_get_value.sym} 3530 -600 0 0 {name=r119 node=i(@m.xmn_cd_load.m0[id])
descr="id="}
C {devices/ngspice_get_value.sym} 3530 -570 0 0 {name=r120 node=@m.xmn_cd_load.m0[gm]
descr="gm="}
C {devices/ngspice_get_expr.sym} 3020 -730 0 0 {name=r121 
node="[format %.4g [expr [ngspice::get_node \{@m.xmn_cs.m0[gm]\}] / [ngspice::get_node \{i(@m.xmn_cs.m0[id])\}]]]"
descr="gm/ID="}
C {devices/ngspice_get_value.sym} 3020 -700 0 0 {name=r122 node=v(@m.xmn_cs.m0[vdsat])
descr="vdsat="}
C {devices/ngspice_get_value.sym} 3020 -670 0 0 {name=r123 node=v(@m.xmn_cs.m0[vds])
descr="vds="}
C {devices/ngspice_get_value.sym} 3080 -730 0 0 {name=r124 node=i(@m.xmn_cs.m0[id])
descr="id="}
C {devices/ngspice_get_value.sym} 3080 -700 0 0 {name=r125 node=@m.xmn_cs.m0[gm]
descr="gm="}
C {devices/ngspice_get_expr.sym} 2500 -540 0 0 {name=r126 
node="[format %.4g [expr [ngspice::get_node \{@m.xmn_load_r.m0[gm]\}] / [ngspice::get_node \{i(@m.xmn_load_r.m0[id])\}]]]"
descr="gm/ID="}
C {devices/ngspice_get_value.sym} 2500 -510 0 0 {name=r127 node=v(@m.xmn_load_r.m0[vdsat])
descr="vdsat="}
C {devices/ngspice_get_value.sym} 2500 -480 0 0 {name=r128 node=v(@m.xmn_load_r.m0[vds])
descr="vds="}
C {devices/ngspice_get_value.sym} 2560 -540 0 0 {name=r129 node=i(@m.xmn_load_r.m0[id])
descr="id="}
C {devices/ngspice_get_value.sym} 2560 -510 0 0 {name=r130 node=@m.xmn_load_r.m0[gm]
descr="gm="}
C {devices/ngspice_get_expr.sym} 1840 -550 0 0 {name=r131 
node="[format %.4g [expr [ngspice::get_node \{@m.xmn_load_l.m0[gm]\}] / [ngspice::get_node \{i(@m.xmn_load_l.m0[id])\}]]]"
descr="gm/ID="}
C {devices/ngspice_get_value.sym} 1840 -520 0 0 {name=r132 node=v(@m.xmn_load_l.m0[vdsat])
descr="vdsat="}
C {devices/ngspice_get_value.sym} 1840 -490 0 0 {name=r133 node=v(@m.xmn_load_l.m0[vds])
descr="vds="}
C {devices/ngspice_get_value.sym} 1900 -550 0 0 {name=r134 node=i(@m.xmn_load_l.m0[id])
descr="id="}
C {devices/ngspice_get_value.sym} 1900 -520 0 0 {name=r135 node=@m.xmn_load_l.m0[gm]
descr="gm="}
C {devices/ngspice_get_expr.sym} 2290 -840 0 0 {name=r136 
node="[format %.4g [expr [ngspice::get_node \{@m.xmp_diff_r.m0[gm]\}] / [ngspice::get_node \{i(@m.xmp_diff_r.m0[id])\}]]]"
descr="gm/ID="}
C {devices/ngspice_get_value.sym} 2290 -810 0 0 {name=r137 node=v(@m.xmp_diff_r.m0[vdsat])
descr="vdsat="}
C {devices/ngspice_get_value.sym} 2290 -780 0 0 {name=r138 node=v(@m.xmp_diff_r.m0[vds])
descr="vds="}
C {devices/ngspice_get_value.sym} 2350 -840 0 0 {name=r139 node=i(@m.xmp_diff_r.m0[id])
descr="id="}
C {devices/ngspice_get_value.sym} 2350 -810 0 0 {name=r140 node=@m.xmp_diff_r.m0[gm]
descr="gm="}
C {devices/ngspice_get_expr.sym} 2000 -840 0 0 {name=r141 
node="[format %.4g [expr [ngspice::get_node \{@m.xmp_diff_l.m0[gm]\}] / [ngspice::get_node \{i(@m.xmp_diff_l.m0[id])\}]]]"
descr="gm/ID="}
C {devices/ngspice_get_value.sym} 2000 -810 0 0 {name=r142 node=v(@m.xmp_diff_l.m0[vdsat])
descr="vdsat="}
C {devices/ngspice_get_value.sym} 2000 -780 0 0 {name=r143 node=v(@m.xmp_diff_l.m0[vds])
descr="vds="}
C {devices/ngspice_get_value.sym} 2060 -840 0 0 {name=r144 node=i(@m.xmp_diff_l.m0[id])
descr="id="}
C {devices/ngspice_get_value.sym} 2060 -810 0 0 {name=r145 node=@m.xmp_diff_l.m0[gm]
descr="gm="}
C {devices/ngspice_get_expr.sym} 2060 -1200 0 0 {name=r146 
node="[format %.4g [expr [ngspice::get_node \{@m.xmp_tail.m0[gm]\}] / [ngspice::get_node \{i(@m.xmp_tail.m0[id])\}]]]"
descr="gm/ID="}
C {devices/ngspice_get_value.sym} 2120 -1200 0 0 {name=r147 node=i(@m.xmp_tail.m0[id])
descr="id="}
C {devices/ngspice_get_expr.sym} 1360 -1300 0 0 {name=r148 
node="[format %.4g [expr [ngspice::get_node \{@m.xmp_mirror.m0[gm]\}] / [ngspice::get_node \{i(@m.xmp_mirror.m0[id])\}]]]"
descr="gm/ID="}
C {devices/ngspice_get_value.sym} 1360 -1270 0 0 {name=r149 node=v(@m.xmp_mirror.m0[vdsat])
descr="vdsat="}
C {devices/ngspice_get_value.sym} 1360 -1240 0 0 {name=r150 node=v(@m.xmp_mirror.m0[vds])
descr="vds="}
C {devices/ngspice_get_value.sym} 1420 -1300 0 0 {name=r151 node=i(@m.xmp_mirror.m0[id])
descr="id="}
C {devices/ngspice_get_value.sym} 1420 -1270 0 0 {name=r152 node=@m.xmp_mirror.m0[gm]
descr="gm="}
C {devices/code_shown.sym} -400 -1410 0 0 {name=COMMANDS2 only_toplevel=false
value="
.save @m.xmp_mirror.m0[gds] 
.save @m.xmp_mirror.m0[gm] 
.save @m.xmp_mirror.m0[id]
.save @m.xmp_mirror.m0[vth]
.save @m.xmp_mirror.m0[vdsat]
.save @m.xmp_mirror.m0[vds]


.save @m.xmp_tail.m0[gds] 
.save @m.xmp_tail.m0[gm] 
.save @m.xmp_tail.m0[id]
.save @m.xmp_tail.m0[vth]
.save @m.xmp_tail.m0[vdsat]
.save @m.xmp_tail.m0[vds]

.save @m.xmp_diff_l.m0[gds] 
.save @m.xmp_diff_l.m0[gm] 
.save @m.xmp_diff_l.m0[id]
.save @m.xmp_diff_l.m0[vth]
.save @m.xmp_diff_l.m0[vdsat]
.save @m.xmp_diff_l.m0[vds]

.save @m.xmp_diff_r.m0[gds] 
.save @m.xmp_diff_r.m0[gm] 
.save @m.xmp_diff_r.m0[id]
.save @m.xmp_diff_r.m0[vth]
.save @m.xmp_diff_r.m0[vdsat]
.save @m.xmp_diff_r.m0[vds]

.save @m.xmn_load_l.m0[gds] 
.save @m.xmn_load_l.m0[gm] 
.save @m.xmn_load_l.m0[id]
.save @m.xmn_load_l.m0[vth]
.save @m.xmn_load_l.m0[vdsat]
.save @m.xmn_load_l.m0[vds]

.save @m.xmn_load_r.m0[gds] 
.save @m.xmn_load_r.m0[gm] 
.save @m.xmn_load_r.m0[id]
.save @m.xmn_load_r.m0[vth]
.save @m.xmn_load_r.m0[vdsat]
.save @m.xmn_load_r.m0[vds]

.save @m.xmp_cs_load.m0[gds] 
.save @m.xmp_cs_load.m0[gm] 
.save @m.xmp_cs_load.m0[id]
.save @m.xmp_cs_load.m0[vth]
.save @m.xmp_cs_load.m0[vdsat]
.save @m.xmp_cs_load.m0[vds]

.save @m.xmn_cs.m0[gds] 
.save @m.xmn_cs.m0[gm] 
.save @m.xmn_cs.m0[id]
.save @m.xmn_cs.m0[vth]
.save @m.xmn_cs.m0[vdsat]
.save @m.xmn_cs.m0[vds]

.save @m.xmn_cd_load.m0[gds] 
.save @m.xmn_cd_load.m0[gm] 
.save @m.xmn_cd_load.m0[id]
.save @m.xmn_cd_load.m0[vth]
.save @m.xmn_cd_load.m0[vdsat]
.save @m.xmn_cd_load.m0[vds]

.save @m.xmn_cd.m0[gds] 
.save @m.xmn_cd.m0[gm] 
.save @m.xmn_cd.m0[id]
.save @m.xmn_cd.m0[vth]
.save @m.xmn_cd.m0[vdsat]
.save @m.xmn_cd.m0[vds]


"}
C {devices/code_shown.sym} 240 -1340 0 0 {name=NGSPICE1 only_toplevel=true
value="
.options abstol=1f 

.control
save all


** Simulation

let tstop = 300e-6
let tstep = 1e-9

op
dc I_IN 100e-9 300e-6 10e-9
**tran $&tstep $&tstop



** Plots

setplot dc1
let v_out = v(out)

let i_in = -(v(out)-v(in_n))/1e3

plot v_out

plot i_in



setplot op1
print @m.xmp_mirror.m0[id]
print cs
print cd
print out

print @m.xmn_cs.m0[vdsat]
print @m.xmn_cs.m0[vds]

print @m.xmp_cs_load.m0[vdsat]
print @m.xmp_cs_load.m0[vds]

print @m.xmn_cd.m0[vdsat]
print @m.xmn_cd.m0[vds]

print @m.xmn_cd_load.m0[vdsat]
print @m.xmn_cd_load.m0[vds]



write TIA_TB_linearity.raw


.endc
"}
C {lab_pin.sym} 2160 -1760 3 1 {name=p40 sig_type=std_logic lab=vss}
C {lab_wire.sym} 1990 -1620 1 0 {name=p41 sig_type=std_logic lab=vss
}
C {vsource.sym} 1990 -1690 0 0 {name=V6 value="1.2" savecurrent=false}
C {launcher.sym} 1100 -1210 0 0 {name=h2
descr="Annotate OP"
tclcommand= "set show_hidden_texts 1; xschem annotate_op"}
C {devices/ngspice_get_value.sym} 2060 -1160 0 0 {name=r153 node=v(@m.xmp_tail.m0[vdsat])
descr="vdsat="}
C {devices/ngspice_get_value.sym} 2060 -1130 0 0 {name=r154 node=v(@m.xmp_tail.m0[vds])
descr="vds="}
C {devices/ngspice_get_value.sym} 2120 -1160 0 0 {name=r155 node=@m.xmp_tail.m0[gm]
descr="gm="}
C {lab_pin.sym} 2200 -900 2 1 {name=p43 sig_type=std_logic lab=vdd}
C {ipin.sym} 1540 -1770 0 0 {name=p44 lab=in_p}
C {lab_pin.sym} 1600 -1770 0 1 {name=p45 sig_type=std_logic lab=in_p
}
C {ipin.sym} 1540 -1710 0 0 {name=p46 lab=vdd}
C {lab_pin.sym} 1600 -1710 0 1 {name=p47 sig_type=std_logic lab=vdd
}
C {ipin.sym} 1540 -1680 0 0 {name=p48 lab=vss}
C {lab_pin.sym} 1600 -1680 0 1 {name=p49 sig_type=std_logic lab=vss
}
C {isource.sym} 2240 -1690 0 0 {name=I3 value=20u}
C {gnd.sym} 2240 -1620 0 0 {name=l5 lab=GND}
C {lab_pin.sym} 2240 -1760 3 1 {name=p50 sig_type=std_logic lab=i_ref}
C {ipin.sym} 1540 -1650 0 0 {name=p51 lab=i_ref}
C {lab_pin.sym} 1600 -1650 0 1 {name=p52 sig_type=std_logic lab=i_ref
}
C {lab_pin.sym} 1520 -1100 1 1 {name=p53 sig_type=std_logic lab=i_ref
}
C {lab_pin.sym} 2550 -730 2 1 {name=p55 sig_type=std_logic lab=cs}
C {lab_pin.sym} 3000 -930 2 1 {name=p56 sig_type=std_logic lab=cd}
C {capa.sym} 3630 -650 0 0 {name=C6
m=1
value=1p
footprint=1206
device="ceramic capacitor"}
C {lab_pin.sym} 1760 -900 2 1 {name=p66 sig_type=std_logic lab=in_n}
C {lab_pin.sym} 3710 -790 0 1 {name=p1 sig_type=std_logic lab=out}
C {lab_pin.sym} 1990 -1760 3 1 {name=p2 sig_type=std_logic lab=in_p}
C {lab_wire.sym} 1750 -1510 1 0 {name=p3 sig_type=std_logic lab=vss
}
C {lab_pin.sym} 1750 -1780 3 1 {name=p4 sig_type=std_logic lab=in_n}
C {isource.sym} 1750 -1690 2 0 {name=I_IN value="PWL(0 1e-9 1e-6 300e-6)"}
C {devices/code_shown.sym} 240 -160 0 0 {name=MODELS only_toplevel=true
format="tcleval( @value )"
value="
.include $::180MCU_MODELS/design.ngspice
.lib $::180MCU_MODELS/sm141064.ngspice typical
.lib $::180MCU_MODELS/sm141064.ngspice res_typical
.lib $::180MCU_MODELS/sm141064.ngspice mimcap_typical
.lib $::180MCU_MODELS/sm141064.ngspice cap_mim
"}
C {lab_pin.sym} 2800 -390 3 1 {name=p5 sig_type=std_logic lab=vdd}
C {symbols/ppolyf_u_1k.sym} 2800 -330 1 0 {name=R1
W=10e-6
L=10e-6
model=ppolyf_u_1k
spiceprefix=X
m=1}
C {lab_pin.sym} 2750 -860 3 1 {name=p6 sig_type=std_logic lab=vdd}
C {symbols/ppolyf_u_1k.sym} 2750 -800 1 0 {name=R2
W=20e-6
L=10e-6
model=ppolyf_u_1k
spiceprefix=X
m=1}
C {symbols/cap_mim_2f0fF.sym} 2840 -800 3 0 {name=C1
W=10e-6
L=10e-6
model=cap_mim_2f0fF
spiceprefix=X
m=15}
